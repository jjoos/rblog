#!/usr/bin/env bash

function echoStep {
  printf $'\e[37;44m\033[1m'"$1"
  echo $'\033[0m'
}

echoStep "Setting up core environment."

if [ ! -d ".git" ]; then
  echoStep "You should run this script from the git repository root of RBlog"
  exit
fi

# Resetting repo to 'just' cloned state.
git clean -ffdx

if [[ ! -e .env ]]; then
  echoStep "Creating a dot env file."
  cat <<"DOTENVFILE" > .env
WEB_PORT=3900
DATABASE_PORT=3910
DOTENVFILE
fi

mkdir -p './tmp/pids/'

if [[ ! -d ./tmp/postgres ]]; then
  echoStep "Creating a data folder for postgres."
  initdb './tmp/postgres' -E utf8 --locale en_US
fi
